window.maskInput=function(){function e(e,n,t){return e.substr(0,n)+t+e.substr(n+t.length)}function n(e,n){for(var t in n)n[t]&&n[t].constructor&&n[t].constructor===Object?(e[t]=e[t]||{},arguments.callee(e[t],n[t])):e[t]=n[t];return e}function t(t,r){var a,o=n({input:"",space:" ",template:"",hardInput:"",formatValue:!1},r||{}),l=o.input,i=o.hardInput,u=o.template,c=new RegExp(function(){for(var e="",n=0;n<l.length;n++)e+=l[n]+"|";return e=e.slice(0,-1)}(),"g"),f=0===i.length?null:new RegExp(function(){for(var e="",n=0;n<i.length;n++)e+=i[n]+"|";return e=e.slice(0,-1)}(),"g"),s=new RegExp(function(){for(var e="",n=0;n<l.length;n++)e+=l[n]+"|";for(var n=0;n<i.length;n++)e+=i[n]+"|";return e=e.slice(0,-1)}(),"g"),v="";a=""!==l?u.replace(c,o.space):u;var h=0,d=function(e,n){for(var t=[],r=0;r<u.length;r++){for(var a=!1,o=0;o<l.length;o++)l[o]===u[r]&&(a=!0);for(var o=0;o<i.length;o++)i[o]===u[r]&&(a=!0);a&&t.push(r)}return t}(u,l),g=u.match(s).length,p=document.getElementById(t),m=p.cloneNode();m.id+="-mask",m.name+="-mask",m.value=a,p.parentNode.insertBefore(m,p),p.style.display="none",m.addEventListener("keydown",function(n){var t=n.which;if(18!==t&&9!==t&&17!==t){n.preventDefault();for(var r=0;g>r;r++){var l=d[r];u[l].match(f)&&(a=e(a,l,u[l]))}if(37===t||8===t)h-=1,0>h&&(h=0);else if(39===t)h+=1,h>=g-1&&(h=g-1);else{var i=String.fromCharCode(n.which);v=e(v,h,i),a=e(a,d[h],i),o.formatValue?p.value=a:p.value=v,m.value=a,h!==g-1&&++h}m.selectionStart=m.selectionEnd=d[h]+1}}),m.addEventListener("click",function(e){var n=m.selectionStart;if(0===n)h=0;else{for(;-1===d.indexOf(n)&&n>0;)--n;h=d.indexOf(n)}m.selectionStart=m.selectionEnd=d[h]+1})}return t}();